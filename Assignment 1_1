// Use of Singly Linked List for implementation of Contact Management System
#include <iostream>
using namespace std;

struct myNode
{
    string number;
    string name;
    string emailID;
    myNode *next;
};

class myList
{
    myNode *head;

public:
    myList();
    ~myList();
    myNode *getNode();
    void create();
    void insertAtHead();
    void insertInBetween();
    void insertAtTail();
    void display();
    void search();
    void reverse();
    void deleteNode();
};
// Constructor
myList::myList()
{
    head = NULL;
}
// Destructor
myList::~myList()
{
    myNode *p;
    while (head != NULL)
    {
        p = head->next;
        delete head;
        head = p;
    }
}
// Returns Node
myNode *myList::getNode()
{
    myNode *t = new myNode;

    // Phone number validation
    while (true)
    {
        cout << "Enter phone number (10 digits): ";
        cin >> t->number;
        bool correct = t->number.size() == 10;
        for (char c : t->number)
            if (!isdigit(c))
                correct = false;
        if (correct)
            break;
        cout << "Invalid phone number.\n";
    }
    cin.ignore();  // To clear the newline after phone input

    // Name validation
    while (true)
    {
        cout << "Enter name: ";
        getline(cin, t->name);
        bool correct = !t->name.empty();
        for (char c : t->name)
            if (!isalpha(c) && c != ' ')
                correct = false;
        if (correct)
            break;
        cout << "Invalid name. Only alphabets and spaces allowed.\n";
    }

    
    cout << "Enter email ID: ";
    getline(cin, t->emailID);

    t->next = NULL;
    return t;
}
// Create list
void myList::create()
{
    int n;
    cout << "Enter number of nodes to be created: ";
    cin >> n;
    cin.ignore();  // Clear newline after integer input

    for (int i = 0; i < n; i++)
    {
        myNode *t = getNode();
        if (head == NULL)
            head = t;
        else
        {
            myNode *p = head;
            while (p->next != NULL)
                p = p->next;
            p->next = t;
        }
    }
}
// Insert at head function
void myList::insertAtHead()
{
    myNode *t = getNode();
    t->next = head;
    head = t;
}
// Insert in between function
void myList::insertInBetween()
{
    string afterName;
    cout << "Insert after which name: ";
    cin.ignore();            // Clear newline before getline
    getline(cin, afterName);

    myNode *t = getNode();
    myNode *p = head;

    while (p != NULL && p->name != afterName)
        p = p->next;

    if (p == NULL)
    {
        cout << "Name not found.\n";
        delete t;
        return;
    }

    t->next = p->next;
    p->next = t;
    cout << "Contact inserted after " << afterName << ".\n";
}
// Insert At tail function
void myList::insertAtTail()
{
    myNode *t = getNode();

    if (head == NULL)
        head = t;
    else
    {
        myNode *p = head;
        while (p->next != NULL)
            p = p->next;
        p->next = t;
    }
}
// Display function
void myList::display()
{
    if (head == NULL)
    {
        cout << "List is empty.\n";
        return;
    }

    cout << "\n--- Contact List ---\n";
    myNode *p = head;
    while (p != NULL)
    {
        cout << "Number : " << p->number << "\n";
        cout << "Name   : " << p->name << "\n";
        cout << "Email  : " << p->emailID << "\n\n";
        p = p->next;
    }
}
// Search by name
void myList::search()
{
    string targetName;
    cout << "Enter name to be searched: ";
    cin.ignore();  // Clear leftover newline before getline
    getline(cin, targetName);

    myNode *p = head;
    while (p != NULL)
    {
        if (p->name == targetName)
        {
            cout << "Contact found:\n";
            cout << "Number: " << p->number << "\nEmail: " << p->emailID << "\n";
            return;
        }
        p = p->next;
    }
    cout << "Data not found\n";
}
// Reverse function
void myList::reverse()
{
    if (head == NULL || head->next == NULL)
        return;

    myNode *prev = NULL, *curr = head, *next = NULL;
    while (curr != NULL)
    {
        next = curr->next;
        curr->next = prev;
        prev = curr;
        curr = next;
    }
    head = prev;
    cout << "List reversed.\n";
    display();
}
// Delete Node function
void myList::deleteNode()
{
    string d;
    cout << "Enter contact number to delete: ";
    cin >> d;

    myNode *p = head, *prev = NULL;

    while (p != NULL && p->number != d)
    {
        prev = p;
        p = p->next;
    }

    if (p == NULL)
    {
        cout << "Data not found\n";
        return;
    }

    if (p == head)
        head = head->next;
    else
        prev->next = p->next;

    delete p;
    cout << "Successfully deleted\n";
}

int main()
{
    myList l;
    int choice;
    l.create();

    do
    {
        cout << "\n--- MENU ---\n";
        cout << "1. Insert at head\n";
        cout << "2. Insert in between\n";
        cout << "3. Insert at tail\n";
        cout << "4. Display\n";
        cout << "5. Search\n";
        cout << "6. Reverse\n";
        cout << "7. Delete node\n";
        cout << "8. Exit\n";
        cout << "Enter your choice: ";
        cin >> choice;

        switch (choice)
        {
        case 1:
            l.insertAtHead();
            break;
        case 2:
            l.insertInBetween();
            break;
        case 3:
            l.insertAtTail();
            break;
        case 4:
            l.display();
            break;
        case 5:
            l.search();
            break;
        case 6:
            l.reverse();
            break;
        case 7:
            l.deleteNode();
            break;
        case 8:
            cout << "Exited the program.\n";
            break;
        default:
            cout << "Enter a valid choice.\n";
        }

    } while (choice != 8);

    return 0;
}
